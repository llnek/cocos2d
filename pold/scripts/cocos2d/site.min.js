"use strict";function _interopRequireDefault(o){return o&&o.__esModule?o:{"default":o}}var _window=require("global/window"),_window2=_interopRequireDefault(_window),_skaro=require("cherimoia/skaro"),_skaro2=_interopRequireDefault(_skaro),_caesar=require("cherimoia/caesar"),_caesar2=_interopRequireDefault(_caesar),ModalWindow=_window2["default"].ModalWindow,document=_window2["default"].document,undef=void 0,$=_window2["default"].jQuery,toggleNavMenuItems=function(){var o=$.cookie("__u982i");_skaro2["default"].isstr(o)&&o.length>0?($("#rego-mitem").parent().hide(),$("#login-mitem").parent().hide(),$("#logout-mitem").parent().show()):($("#rego-mitem").parent().show(),$("#login-mitem").parent().show(),$("#logout-mitem").parent().hide())},paintDoors=function(){var o=$("#intro img");if(!(null===o||o.length<=0)){var e=o.length,t=0;$(o[0]).addClass("open-door"),_window2["default"].setInterval(function(){o.removeClass("open-door"),++t,t>=e&&(t=0),$(o[t]).addClass("open-door")},1500)}},initOverlay=function(){var o=($("#rego-mitem"),$("#logout-mitem")),e=($("#login-mitem"),$("#register_form"),$("#login_form"),$("#forgotpwd_form"),$("#forgot-password")),t=$("#backto-login"),a=$("#register-send"),n=$("#login-send"),i=$("#forgot-send");e.on("click",function(){document.location.href=document.location.origin+"/users/forgotlogin"}),t.on("click",function(){document.location.href=document.location.origin+"/users/login"});var r=function(o){var e=$("#pg-footer").attr("data-ref")||"";return _skaro2["default"].R.reduce(function(o,t){var a=$(t),n=a.attr("data-name"),i=a.val()||"";return("credential"===n||"principal"===n)&&i&&e&&(i=_caesar2["default"].encrypt(_skaro2["default"].base64_encode(i),13)),o[n]=i,o},{},$("input",o))},l=function(o,e,t,a,n){var i=$(o),l={},s=r(i),c=i.attr("action");if(_skaro2["default"].echt(a)){var u=_skaro2["default"].toBasicAuthHeader($('input[name="'+a+'"]',i).val(),$('input[name="'+n+'"]',i).val());l[u[0]]=u[1]}$.ajax(c,{contentType:"application/json",headers:l,data:_skaro2["default"].jsonfy(s),type:"POST",dataType:"json"}).done(e).fail(t)},s=function(o,e,t){$.ajax(o,{}).done(e).fail(t)};a.on("click",function(o){var e=$("#register .acctxxx-result");_skaro2["default"].pde(o);var t=function(o){var t="Bad request.";409===o.status&&(t="Account with same id already exist.");var a="<p>Account creation failed: "+t+"</p>";e.empty().html(a),e.show()},a=function(){var o='<div class="login-actions"><p>Account created successfully.<br/><a href="/users/login">Continue to login?</a></p></div>';e.empty().html(o),e.show()};l("#register_form",a,t)}),o.on("click",function(){var o=function(){alert("Logout failed")},e=function(){document.location.href=document.location.origin};s("/users/logout",e,o)}),n.on("click",function(o){var e=$("#login .acctxxxx-result");_skaro2["default"].pde(o);var t=function(){e.empty().html("<p>Login failed.  Did you mistype?</p>"),e.show()},a=function(){document.location.href=document.location.origin+"/games/toppicks"};e.hide(),l("#login_form",a,t,"login-email","login-password")}),i.on("click",function(o){var e=$("#forgotpwd .acctxxxx-result");_skaro2["default"].pde(o);var t=function(){e.empty().html("<p>Failed to send message.  Please try again later.</p>"),e.show()},a=function(){e.empty().html("<p>Message sent.</p>"),e.show()};e.hide(),l("#forgotpwd_form",a,t)})},initCarousel=function(){var o=$("#toppicks .owl-carousel");null===o||0===o.length||o.owlCarousel({singleItem:!0,items:1,navigation:!0,navigationText:["<",">"]})},boot=function(){var o=$("html");_skaro2["default"].isSafari()?o.addClass("is-safari"):o.removeClass("is-safari"),$(".navbar-toggle").on("click",function(){var o=$(".navbar-collapse"),e=$(".navbar");o.hasClass("in")?o.hasClass("in")&&e.removeClass("darken-menu"):e.addClass("darken-menu")}),$(".nav a").on("click",function(){$("#main-nav").removeClass("in").addClass("collapse")}),$(".intro-section .scroll-more").click(function(o){var e=$("body").children("section").eq(1);$("html, body").animate({scrollTop:$(e).offset().top},1200,"easeInOutCubic"),_skaro2["default"].pde(o)}),$("body").waypoint(function(){$(".navbar").toggleClass("minified dark-menu")},{offset:"-200px"}),initCarousel(),initOverlay(),paintDoors(),$(document).scroll(function(){var o=$("#intro").outerHeight(),e=$(document).scrollTop(),t=$(".scrolltotop");e>=o-100?t.addClass("show-to-top"):t.removeClass("show-to-top")}),toggleNavMenuItems()};$(document).ready(boot);